(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1:function(e,t,n){"use strict";n.r(t);var r=n(22),a=n(12);n(36);function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=n(33);n(34);window.memory=a.m;var c=n(53),s=n(54),l=function(e){var t,n=e.canvas,r=e.universe,i=e.isSnapshot,l=void 0!==i&&i,u=e.gl;t=o(u?{gl:u,attributes:{preserveDrawingBuffer:l}}:{canvas:n,attributes:{preserveDrawingBuffer:l}});var f=r.width(),d=r.height(),p=r.cells(),m=new Uint8Array(a.m.buffer,p,f*d*4),v=t.texture({width:f,height:d,data:m}),h=t({blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},frag:c,uniforms:{t:function(e){return e.tick},skyTime:function(){return window.skyTime||0},dataTexture:function(){return p=r.cells(),m=new Uint8Array(a.m.buffer,p,f*d*4),v({width:f,height:d,data:m})},resolution:function(e){return[e.viewportWidth,e.viewportHeight]},dpi:4,isSnapshot:l},vert:s,attributes:{position:[[-1,4],[-1,-1],[4,-1]]},count:3});return{regl:t,draw:function(){t.poll(),h()}}};function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f,d=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fps=document.getElementById("fps"),this.frames=[],this.lastFrameTimeStamp=performance.now()}var t,n,r;return t=e,(n=[{key:"render",value:function(){var e=performance.now(),t=e-this.lastFrameTimeStamp;this.lastFrameTimeStamp=e;var n=1/t*1e3;this.frames.push(n),this.frames.length>30&&this.frames.shift();for(var r=1/0,a=-1/0,i=0,o=0;o<this.frames.length;o++)i+=this.frames[o],r=Math.min(this.frames[o],r),a=Math.max(this.frames[o],a);var c=i/this.frames.length;this.fps.textContent="FPS:".concat(Math.round(c))}}])&&u(t.prototype,n),r&&u(t,r),e}());function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=document.getElementById("sand-canvas"),h=0;var y=function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2),2)},g=function(e){var t=function(e){return Math.sqrt(Math.pow(e.clientX,2)+Math.pow(e.clientY,2),2)}(e);return{clientX:e.clientX/t,clientY:e.clientY/t}},w=function(e,t){return{clientX:e.clientX*t,clientY:e.clientY*t}},x=function(e,t){return{clientX:e.clientX+t.clientX,clientY:e.clientY+t.clientY}},b=function(e,t){return{clientX:e.clientX-t.clientX,clientY:e.clientY-t.clientY}},E=!1,k=null,S=null;function _(e){clearInterval(S),S=window.setInterval((function(){return I(e)}),100);var t={clientX:e.clientX,clientY:e.clientY};if(E){var n=O[window.UI.state.selectedElement]||2,a=0;if(I(t),k&&window.UI.state.selectedElement!=r.f.Fish&&window.UI.state.selectedElement!=r.f.GoldFish)for(;y(t,k)>n/3;){var i=y(t,k);if(t=x(t,w(g(b(k,e)),Math.min(n/3,i))),++a>1e3)break;I(t)}k=e}}v.addEventListener("mousedown",(function(e){e.preventDefault(),me.push_undo(),E=!0,clearInterval(S),S=window.setInterval((function(){return I(e)}),100),I(e),k=e})),document.body.addEventListener("mouseup",(function(e){clearInterval(S),E&&(e.preventDefault(),k=null,E=!1)})),v.addEventListener("mousemove",(function(e){clearInterval(S),_(e)})),v.addEventListener("mouseleave",(function(e){clearInterval(S),k=null})),v.addEventListener("touchstart",(function(e){e.cancelable&&e.preventDefault();Array.from(e.touches);me.push_undo(),E=!0,k=e,C(e)})),v.addEventListener("touchend",(function(e){e.cancelable&&e.preventDefault(),k=null,E=!1,clearInterval(S)})),v.addEventListener("touchmove",(function(e){window.paused||e.cancelable&&e.preventDefault(),clearInterval(S),C(e)}));var C=function(e){var t=Array.from(e.touches);1==t.length?_(t[0]):t.forEach(I)},O=(m(f={},r.f.Water,13),m(f,r.f.Sand,8),m(f,r.f.Empty,7),m(f,r.f.Algae,2),m(f,r.f.Fish,2),m(f,r.f.GoldFish,2),m(f,r.f.Daphnia,2),m(f,r.f.Zoop,2),m(f,r.f.Grass,2),m(f,r.f.Bacteria,2),f);var I=function(e){if(E&&(window.UI.state.selectedElement!=r.f.Fish&&window.UI.state.selectedElement!=r.f.GoldFish||Date.now()-h>1e3&&(h=Date.now(),1))){var t=p(function(e){var t=v.getBoundingClientRect(),n=v.width/(he*Math.ceil(window.devicePixelRatio))/t.width,r=v.height/(he*Math.ceil(window.devicePixelRatio))/t.height,a=(e.clientX-t.left)*n,i=(e.clientY-t.top)*r;return[Math.min(Math.floor(a),ye-1),Math.min(Math.floor(i),ge-1)]}(e),2),n=t[0],a=t[1];if(!(window.UI.state.selectedElement<0)){var i=O[window.UI.state.selectedElement]||3;me.paint(n,a,i,window.UI.state.selectedElement)}}},z=n(2),j=n.n(z),D=n(56),A=n.n(D),M=n(10),N=n(21),P=function(){return j.a.createElement("div",{className:"welcome-scrim"},j.a.createElement("div",{className:"Info window"},j.a.createElement("div",{className:"title-bar"},j.a.createElement("div",{className:"title-bar-text"},"Information"),j.a.createElement("div",{className:"title-bar-controls"},j.a.createElement(M.b,{to:"/"},j.a.createElement("button",{"aria-label":"Minimize"})),j.a.createElement("button",{"aria-label":"Maximize"}),j.a.createElement(M.b,{to:"/"},j.a.createElement("button",{"aria-label":"Close"}," ")))),j.a.createElement("div",{className:"window-body "})))},L=function(e){var t=e.close,n=e.children;return j.a.createElement("div",{className:"welcome-scrim"},j.a.createElement("div",{id:"welcome"},n,j.a.createElement(M.b,{to:"/",className:"x",onClick:t},j.a.createElement("button",null," x"))))};function T(e,t,n){return(T=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&H(a,n.prototype),a}).apply(null,arguments)}function R(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e,t,n){return t&&G(e.prototype,t),n&&G(e,n),e}function B(e,t){return!t||"object"!==U(t)&&"function"!=typeof t?Y(e):t}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}console.log(r.g),console.log(r.e),console.log(r.b);var K=[{key:r.g.None,symbol:"âµ”"},{key:r.g.Horizontal,symbol:"ðŸœ•"},{key:r.g.Vertical,symbol:"ðŸœ”"},{key:r.g.Quad,symbol:"ðŸœ¨"}],J=[{key:r.e.Anything,symbol:" "},{key:r.e.Empty,symbol:"Ã—"}],Q=[{key:r.b.Nop,symbol:" "},{key:r.b.Empty,symbol:"Ã—"},{key:r.b.Me,symbol:"â˜‰"}];function V(e,t){return 3*t+e}var Z=function(e){function t(e){return F(this,t),B(this,X(t).call(this,e))}return W(t,e),q(t,[{key:"gridSquare",value:function(e,t,n){var r=this,a=this.props,i=a.grid,o=a.options,c=i[V(e,t)],s=o[c].symbol;return j.a.createElement("g",{key:"".concat(e,"-").concat(t),transform:"translate(".concat(55*e+15,",").concat(55*t+15,")"),className:n?"disabled":"",onClick:function(){n||(i[V(e,t)]=(c+1)%r.props.options.length,(0,r.props.setGrid)(i))}},j.a.createElement("rect",{x:0,y:0,width:"50",height:"50",className:"mat-box",style:{fill:" "==s?"#c0c0c0":"",strokeWidth:1}}),j.a.createElement("text",{x:25,y:30,style:{fontSize:"30px"}},n?"â˜‰":s))}},{key:"render",value:function(){var e=this.props.isSelector;return j.a.createElement("g",null,[this.gridSquare(0,0),this.gridSquare(0,1),this.gridSquare(0,2),this.gridSquare(1,0),this.gridSquare(1,1,e),this.gridSquare(1,2),this.gridSquare(2,0),this.gridSquare(2,1),this.gridSquare(2,2)])}}]),t}(j.a.Component),$=function(e){function t(e){var n;return F(this,t),(n=B(this,X(t).call(this,e))).state={rule:{selector:[0,0,0,0,0,0,0,1,0],effector:[0,0,0,0,1,0,0,2,0],symmetry:0}},window.Editor=Y(n),n}return W(t,e),q(t,[{key:"setRule",value:function(){var e=this.state.rule,t=e.selector,n=e.effector,a=e.symmetry,i=T(r.d,R(t.map((function(e){return J[e].key})))),o=T(r.a,R(n.map((function(e){return Q[e].key})))),c=new r.c(K[a].key,i,o);window.u.set_rule(c)}},{key:"render",value:function(){var e=this,t=this.state.rule,n=t.selector,r=t.effector,a=t.symmetry;return j.a.createElement("div",{className:"MatrixMenu"},j.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"-10 0 410 200",width:"100%"},j.a.createElement("circle",{cx:12,cy:94,r:"16",className:"mat-circle",style:{strokeWidth:1,fill:"white"}}),j.a.createElement("text",{x:"12",y:"98",style:{fontSize:"30px"},onClick:function(){var t=e.state.rule;t.symmetry=(a+1)%K.length,e.setState({rule:t},e.setRule)}},K[a].symbol),j.a.createElement("g",{transform:"translate(20,0)"},j.a.createElement(Z,{options:J,grid:n,isSelector:!0,setGrid:function(t){var n=e.state.rule;n.selector=t,e.setState({rule:n},e.setRule)}})),j.a.createElement("g",{transform:"translate(195,80)"},j.a.createElement("polygon",{fill:"white",stroke:"black",points:"15,0, 25,15 15,30, 15,20, 8,20, 8,10, 15,10 "})),j.a.createElement("g",{transform:"translate(210,0)"},j.a.createElement(Z,{options:Q,grid:r,setGrid:function(t){var n=e.state.rule;n.effector=t,e.setState({rule:n},e.setRule)}}))))}}]),t}(j.a.Component);function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(n,!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.species=r.f;var se=function(){var e=document.createElement("canvas"),t=Object.values(r.f).filter((function(e){return!isNaN(parseFloat(e))})),n=Math.max.apply(Math,i(t))+1,a=r.h.new(n,1);e.width=n,e.height=3,a.reset(),t.forEach((function(e){return a.paint(e,0,2,e)})),a.paint(t.Empty,0,2,t.Empty),(0,l({universe:a,canvas:e,isSnapshot:!0}).draw)();var o=e.getContext("webgl"),c=new Uint8Array(4*n);o.readPixels(0,0,n,1,o.RGBA,o.UNSIGNED_BYTE,c);var s={};return t.forEach((function(e){var t=4*e,n="rgba(".concat(c[t],",").concat(c[t+1],", ").concat(c[t+2],", 1.0)");s[e]=n})),s}(),le=function(e){var t=e.onClick,n=e.className,r=e.style,a=e.children;return j.a.createElement("button",{onClick:t,className:n,style:oe({},r)},a)},ue=function(e){function t(e){var n,a,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=!(i=ne(t).call(this,e))||"object"!==ee(i)&&"function"!=typeof i?re(a):i;localStorage.getItem("tutorialProgress");return n.state={submissionMenuOpen:!1,paused:!1,ff:!1,submitting:!1,size:1,dataURL:null,currentSubmission:null,selectedElement:r.f.Rule1},window.UI=re(n),window.setTimeout((function(){}),1e4),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(t,e),n=t,(i=[{key:"componentDidUpdate",value:function(e){}},{key:"togglePause",value:function(){window.paused=!this.state.paused,this.setState({paused:!this.state.paused})}},{key:"toggleFF",value:function(){window.ff=!this.state.ff,this.setState({ff:!this.state.ff})}},{key:"play",value:function(){window.paused=!1,this.setState({paused:!1})}},{key:"pause",value:function(){window.paused=!0,this.setState({paused:!0})}},{key:"setSize",value:function(e,t){e.preventDefault(),this.setState({size:t})}},{key:"reset",value:function(){window.confirm("Reset your ecosystem?")&&(this.play(),this.setState({currentSubmission:null}),Se())}},{key:"closeMenu",value:function(){this.play(),this.setState({dataURL:null})}},{key:"upload",value:function(){console.log("saving");var e=new Uint8Array(a.m.buffer,me.cells(),ye*ge*4),t=document.createElement("canvas"),n=t.getContext("2d"),r=n.createImageData(ye,ge);t.height=ge,t.width=ye;for(var i=0;i<ye*ge*4;i++)r.data[i]=i%4==3?255:e[i];n.putImageData(r,0,0);var o=t.toDataURL("image/png"),c=JSON.stringify(o);try{localStorage.setItem("cell_data",c),localStorage.setItem("time",window.t)}catch(e){console.log("store failed")}}},{key:"currentDateString",value:function(){var e=new Date;return"".concat(e.getMonth(),"-").concat(e.getDate())}},{key:"load",value:function(){var e=this;console.log("loading");var t=JSON.parse(localStorage.getItem("cell_data"));if(!t)return console.log("no save"),void window.setInterval((function(){return e.upload()}),1e4);var n=document.createElement("canvas");n.width=ye,n.height=ge;var r=n.getContext("2d"),i=new Image;i.src=t,i.onload=function(){r.drawImage(i,0,0);for(var t=r.getImageData(0,0,n.width,n.height),o=new Uint8Array(a.m.buffer,me.cells(),ye*ge*4),c=0;c<ye*ge*4;c++)o[c]=t.data[c];window.setInterval((function(){return e.upload()}),1e4)}}},{key:"render",value:function(){var e=this,t=this.state,n=(t.ff,t.selectedElement),a=t.currentSubmission,i=t.paused,o=(a&&a.id&&"#".concat(a.id),Object.keys(r.f).filter((function(e){return e.length>2})));return j.a.createElement("div",{className:"window fade",id:"HUD"},j.a.createElement("div",{className:"title-bar"},j.a.createElement("div",{className:"title-bar-text"},"Tile Toy"),j.a.createElement("div",{className:"title-bar-controls"},j.a.createElement("button",{"aria-label":"Minimize",onClick:function(){document.body.classList.add("faded")}}),j.a.createElement("button",{"aria-label":"Maximize"}),j.a.createElement("button",{"aria-label":"Close",onClick:function(){document.body.classList.add("faded")}}))),j.a.createElement("div",{className:"window-body hud-body"},j.a.createElement("div",{id:"hud-buttons"},j.a.createElement(le,{onClick:function(){return e.togglePause()},className:i?"selected":""},i?j.a.createElement("svg",{className:"bsvg",height:"20",width:"20",id:"d",viewBox:"-50 -50 400 400"},j.a.createElement("polygon",{id:"play",points:"0,0 , 300,150 0,300"})):j.a.createElement("svg",{className:"bsvg",height:"20",width:"20",id:"d",viewBox:"-50 -50 400 400"},j.a.createElement("polygon",{id:"bar2",points:"0,0 110,0 110,300 0,300"}),j.a.createElement("polygon",{id:"bar1",points:"190,0 300,0 300,300 190,300"}))),j.a.createElement(le,{onClick:function(){return e.reset()}},"Reset"),j.a.createElement(le,{onClick:function(){me.pop_undo()},style:{fontSize:18}},"â†œ"),o.map((function(t){return function(e,t,n){var a=r.f[e],i=se[a],o=a==t,c=e;return"Empty"==e&&(c="Clear"),"Rule1"==e&&(c="â˜‰"),j.a.createElement("button",{className:o?"selected ".concat(e):e,key:e,onClick:function(){n(a)},style:{background:"inherit",backgroundColor:i,borderColor:i,filter:o||"saturate(0.4) "}},"  ",c,"  ")}(t,n,(function(t){return e.setState({selectedElement:t})}))})),j.a.createElement($,null),this.state.dataURL&&j.a.createElement(L,{close:function(){return e.closeMenu()}},j.a.createElement("img",{src:this.state.dataURL,className:"submissionImg"}),j.a.createElement("div",{style:{display:"flex"}})))))}}])&&te(n.prototype,i),o&&te(n,o),t}(j.a.Component);A.a.render(j.a.createElement((function(){return j.a.createElement(M.a,null,j.a.createElement(N.a,{path:"/",component:ue}),j.a.createElement(N.a,{exact:!0,path:"/info/",component:P}))}),null),document.getElementById("ui"));n(68);n.d(t,"canvas",(function(){return we})),n.d(t,"width",(function(){return ye})),n.d(t,"height",(function(){return ge})),n.d(t,"ratio",(function(){return he})),n.d(t,"universe",(function(){return me})),n.d(t,"reset",(function(){return Se}));var fe=150,de=75,pe=144,me=r.h.new(fe,fe);function ve(){me.paint(de,de,pe+2,r.f.Glass),me.paint(de,de,pe-2,r.f.Empty)}ve();var he=3,ye=fe,ge=fe,we=document.getElementById("sand-canvas");we.height=fe*he*Math.ceil(window.devicePixelRatio),we.width=fe*he*Math.ceil(window.devicePixelRatio);var xe=document.getElementById("HUD"),be=function(){var e=window.innerWidth,t="",n="";if(e-150>window.innerHeight-50){t="height: ".concat(window.innerHeight,"px; margin:3px"),window.innerHeight;var r=e-window.innerHeight-12;n="width: ".concat(r,"px; margin: 2px;")}else e,t="width: ".concat(e,"px; ");xe.style=n,we.style=t};be(),window.addEventListener("deviceorientation",be,!0),window.addEventListener("resize",be);var Ee=l({canvas:we,universe:me}),ke=parseInt(localStorage.getItem("time"),10)||0;function Se(){console.log("reseting"),localStorage.setItem("cell_data",null),me.reset(),ve()}window.u=me,window.universe=me,window.Editor.setRule(),function e(){for(var t=performance.now(),n=window.ff?100:1,r=0;r<n;r++){if(window.paused||(d.render(),me.tick()),performance.now()-t>16)break}window.t=ke,Ee.draw(),requestAnimationFrame(e)}(),window.UI.load()},12:function(e,t,n){"use strict";var r=n.w[e.i];e.exports=r;n(22);r.D()},22:function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return w})),n.d(t,"i",(function(){return x})),n.d(t,"j",(function(){return b}));var r=n(12);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}var c=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});c.decode();var s=null;function l(e,t){return c.decode((null!==s&&s.buffer===r.m.buffer||(s=new Uint8Array(r.m.buffer)),s).subarray(e,e+t))}function u(e,t){if(!(e instanceof t))throw new Error("expected instance of ".concat(t.name));return e.ptr}var f,d=Object.freeze({Empty:0,0:"Empty",Glass:1,1:"Glass",Sand:2,2:"Sand",Rule1:3,3:"Rule1",Water:4,4:"Water"}),p=Object.freeze({None:0,0:"None",Vertical:1,1:"Vertical",Horizontal:2,2:"Horizontal",Quad:3,3:"Quad"}),m=Object.freeze({Empty:0,0:"Empty",Anything:1,1:"Anything",Full:2,2:"Full",Glass:3,3:"Glass",Water:4,4:"Water"}),v=Object.freeze({Empty:0,0:"Empty",Nop:1,1:"Nop",Me:2,2:"Me"}),h=function(){function e(t,n,i,o,c,s,l,u,f){a(this,e);var d=r.l(t,n,i,o,c,s,l,u,f);return e.__wrap(d)}return o(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,r.b(e)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}}]),e}(),y=function(){function e(t,n,i){a(this,e),u(n,g);var o=n.ptr;n.ptr=0,u(i,h);var c=i.ptr;i.ptr=0;var s=r.n(t,o,c);return e.__wrap(s)}return o(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,r.f(e)}},{key:"symmetry",get:function(){return r.e(this.ptr)>>>0},set:function(e){r.j(this.ptr,e)}},{key:"selector",get:function(){var e=r.d(this.ptr);return g.__wrap(e)},set:function(e){u(e,g);var t=e.ptr;e.ptr=0,r.i(this.ptr,t)}},{key:"effector",get:function(){var e=r.c(this.ptr);return h.__wrap(e)},set:function(e){u(e,h);var t=e.ptr;e.ptr=0,r.h(this.ptr,t)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}}]),e}(),g=function(){function e(t,n,i,o,c,s,l,u,f){a(this,e);var d=r.o(t,n,i,o,c,s,l,u,f);return e.__wrap(d)}return o(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,r.g(e)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}}]),e}(),w=function(){function e(){a(this,e)}return o(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,r.k(e)}},{key:"reset",value:function(){r.x(this.ptr)}},{key:"tick",value:function(){r.B(this.ptr)}},{key:"rule",value:function(){var e=r.y(this.ptr);return y.__wrap(e)}},{key:"set_rule",value:function(e){u(e,y),r.z(this.ptr,e.ptr)}},{key:"width",value:function(){return r.C(this.ptr)}},{key:"height",value:function(){return r.r(this.ptr)}},{key:"cells",value:function(){return r.p(this.ptr)}},{key:"paint",value:function(e,t,n,a){r.u(this.ptr,e,t,n,a)}},{key:"push_undo",value:function(){r.w(this.ptr)}},{key:"pop_undo",value:function(){r.v(this.ptr)}},{key:"flush_undos",value:function(){r.q(this.ptr)}},{key:"set_time",value:function(e){r.A(this.ptr,e)}},{key:"inc_time",value:function(){r.s(this.ptr)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new",value:function(t,n){var a=r.t(t,n);return e.__wrap(a)}}]),e}(),x="function"==typeof Math.random?Math.random:(f="Math.random",function(){throw new Error("".concat(f," is not defined"))}),b=function(e,t){throw new Error(l(e,t))}}).call(this,n(35)(e))},41:function(e,t){},43:function(e,t){},53:function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\nuniform float t;\nuniform float skyTime;\n\nuniform float dpi;\nuniform vec2 resolution;\nuniform bool isSnapshot;\nuniform sampler2D backBuffer;\nuniform sampler2D dataTexture;\n\nvarying vec2 uv;\nconst float PI2 = 2. * 3.14159265358979323846;\n\n// clang-format off\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_0(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_0(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_0(vec4 x) {\n     return mod289_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise_0(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g_0 = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g_0;\n  vec3 i1 = min( g_0.xyz, l.zxy );\n  vec3 i2 = max( g_0.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289_0(i);\n  vec4 p = permute_0( permute_0( permute_0(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_1(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289_1(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute_1(vec3 x) {\n  return mod289_1(((x*34.0)+1.0)*x);\n}\n\nfloat snoise_1(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289_1(i); // Avoid truncation effects in permutation\n  vec3 p = permute_1( permute_1( i.y + vec3(0.0, i1.y, 1.0 ))\n    + i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\n// clang-format on\n\nvoid main() {\n  vec2 guv = uv;\n  vec3 color;\n  vec2 grid = floor(guv * (resolution / (dpi * 2.)));\n\n  grid = floor(guv * (resolution / dpi));\n\n  float noise = snoise_0(vec3(grid, t * 0.05));\n  vec2 noise_2d = vec2(floor(0.5 + noise),\n                       floor(0.5 + snoise_0(vec3(grid, (t + 20.) * 0.05))));\n\n  vec2 textCoord = (guv * vec2(0.5, -0.5)) + vec2(0.5);\n  vec2 sampleCoord = textCoord + (noise_2d / (resolution / 2.));\n\n  vec4 data = texture2D(dataTexture, textCoord);\n\n  int type = int((data.r * 255.) + 0.1);\n  float energy = data.g;\n  float age = data.b;\n\n  float hue = 0.0;\n  float saturation = 0.6;\n  float lightness = 0.3 + energy * 0.5;\n  float a = 1.0;\n  float brightness = 0.0;\n\n  if (type == 0) { // Air\n\n    hue = 0.0;\n    saturation = 0.1;\n    lightness = 0.1;\n    a = 0.0;\n    if (isSnapshot) {\n      saturation = 0.05;\n      lightness = 1.01;\n      a = 1.0;\n    }\n\n  } else if (type == 1) { // Glass\n    hue = 0.1;\n    saturation = 0.2;\n    lightness = 1.0;\n  } else if (type == 2) { // Sand\n    hue = 0.1;\n    saturation = 0.4 + (age * 0.3);\n    lightness = 1.0 - energy * 0.5;\n\n  } else if (type == 3) { // Water\n    hue = 0.58;\n    saturation = 0.6;\n    lightness = 0.5 + energy * 0.25 + noise * 0.1;\n    a = 0.4;\n    if (isSnapshot) {\n      a = 1.0;\n    }\n  } else if (type == 4) { // Algae\n    hue = 0.4 - age * 0.3;\n    lightness += 0.1;\n    saturation = 0.5 - (energy * .1);\n    a = 0.8;\n  } else if (type == 5) { // Plant\n    hue = 0.4;\n    saturation = 0.4;\n\n    if (energy > 45. / 255.) {\n      hue = 0.48;\n    }\n    if (age == 0.) {\n      // saturation = 0.9;\n    }\n    lightness = 0.2 + (1.0 - energy) * 0.4;\n\n  } else if (type == 6) { // Zoop\n    hue = 0.9;\n    lightness += 0.7;\n  } else if (type == 7) { // Fish\n    hue = 0.0;\n    lightness += 0.4;\n  } else if (type == 8) { // Bacteria\n    hue = 0.66;\n    saturation += 0.2;\n    lightness += 0.2;\n    a = 0.4;\n    if (isSnapshot) {\n      // lightness += 0.8;\n      saturation -= 0.2;\n\n      a = 1.0;\n    }\n\n  } else if (type == 9) { // ???\n    hue = 0.6;\n    saturation = 0.4;\n    lightness = 0.7 + data.g * 0.5;\n  } else if (type == 10) { // Waste\n    hue = 0.9;\n    lightness -= 0.2;\n    saturation = 0.4;\n    a = 0.8;\n  } else if (type == 11) { // Grass\n    hue = 0.4;\n    saturation = 0.4;\n  } else if (type == 12) { // Stone\n    hue = -0.4 + (data.g * 0.5);\n    saturation = 0.1;\n  } else if (type == 13) { // Wood\n    hue = (data.g * 0.1);\n    saturation = 0.3;\n    lightness = 0.3 + data.g * 0.3;\n  } else if (type == 14) { // Egg\n    hue = 0.9;\n    saturation = age / 3.;\n    lightness = 1.0;\n    a = 0.8;\n\n  } else if (type == 15) { // Tail\n    hue += fract(age * 1.9 * 255. / 8.) * 0.2;\n    lightness += 0.4;\n    saturation -= (fract(age * 1.9 * 255. / 8.) - 0.1) * 0.7;\n\n    // saturation += fract(age * 255.*6.);\n  } else if (type == 16) { // bubble\n\n    hue = 0.0;\n    saturation = 0.1;\n    lightness = 0.1;\n    a = 0.0;\n    if (isSnapshot) {\n      saturation = 0.05;\n      lightness = 1.01;\n      a = 1.0;\n    }\n  } else if (type == 17) { // biofilm\n    hue = 0.48;\n    saturation = 0.6;\n    lightness = 0.5 + energy * 0.25 + noise * 0.1;\n    a = 0.4;\n    if (isSnapshot) {\n      a = 1.0;\n    }\n  } else if (type == 18) { // goldfish\n    hue = 0.1;\n    lightness += 0.3;\n    saturation = 0.9;\n  } else if (type == 19) { // goldfishtail\n    hue = 0.1;\n    hue += fract(age * 1.9 * 255. / 9.) * 0.1;\n    lightness += 0.6;\n    saturation = 0.9;\n    saturation -= (fract(age * 1.9 * 255. / 7.) - 0.1) * 0.6;\n  } else if (type == 20) { // plastic\n    hue = 0.1;\n    lightness += 0.5;\n    saturation = 0.1;\n  }\n  lightness *= 0.85 + cos(skyTime * PI2) * 0.2;\n\n  if (isSnapshot == false) {\n    lightness *= (0.975 + snoise_1(floor(guv * resolution / dpi)) * 0.025);\n  }\n  saturation = min(saturation, 1.0);\n  lightness = min(lightness, 1.0);\n  color = hsv2rgb(vec3(hue, saturation, lightness));\n\n  gl_FragColor = vec4(color, a);\n  // gl_FragColor = getColor(uv);\n}"},54:function(e,t){e.exports='\n// boring "pass-through" vertex shader\nprecision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}'},68:function(e,t){var n=document.getElementById("background"),r=window.setTimeout((function(){window.UI.state.tutorialProgress>3&&document.body.classList.add("faded")}),3e4),a=function(e){window.clearTimeout(r),document.body.classList.remove("faded"),r=window.setTimeout((function(){window.UI.state.tutorialProgress>3&&document.body.classList.add("faded")}),3e4)};document.body.addEventListener("mousemove",a),document.body.addEventListener("touchstart",a),n.addEventListener("touchmove",(function(e){window.paused||e.cancelable&&e.preventDefault()}))}}]);
//# sourceMappingURL=2.7b668a48162e0c4d2a79.js.map